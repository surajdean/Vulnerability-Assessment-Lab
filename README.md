<h1> Vulnerability Assessment Lab </h1>

In this guide, I'll be guiding you through setting up a Windows Virtual Machine and using Nessus, a powerful vulnerability scanner. This hands-on project will enhance your expertise in virtual machine management and effective vulnerability scanning.

<h2>Tools Used</h2>

- <b>VirtualBox</b> 
- <b>Nessus</b>

<h2>Environments Used </h2>

- <b>Windows 10 VM</b>

<h2>Program walk-through:</h2>

<h3>Step 1: Download and set up the Virtual Box hypervisor</h3>

Go to the BIOS/UEFI of your computer and enable hardware virtualization support. Use this article for guidance.

Download Oracle's VirtualBox for your respective OS and the VirtualBox Extension Pack from this website. Install VirtualBox using all the default configurations.

Step 2: Download the Windows 10 ISO file

Download the Windows 10 installation media here. This will give you a media creation tool that will generate a Windows ISO image file

Choose the create installation media (USB flash drive, DVD, or ISO file) for another PC option

Check the option for the recommended options for your PC

Choose the option for ISO file and save it

Step 3: Create a Windows VM in VirtualBox 

We will now use the Windows ISO file we generated to set up a VM inside VirtualBox

Click on New to create a VM
Create a name for your VM, a folder you want to save the VM inside and select the Windows ISO file you previously generated
Configure your VM's specifications for hardware and its virtual hard disk (this will be dependent upon your host computer's specifications), then click Finish
Click the green arrow that says Start
You should now be seeing a Windows 10 setup screen within the VM. Click Next and Install Now
When you get to the Activate Windows screen, click I don't have a product key
When it asks you for the operating system you want to install, select Windows 10 Pro and click Next
Accept the license terms
Choose the custom install option and continue pressing Next

Step 4: Prepare your Windows 10 VM environment for Nessus
To prepare our VM for scanning using Nessus, we need to make it more vulnerable so Nessus can accurately identify any vulnerabilities and weaknesses.
Go to Settings and then click on Update & Security
Click Pause updates for 7 days (this can be further extended in the advanced options depending on how long you intend to work on this lab)
Click View update history
Click Uninstall updates and go through each update to try to install them if possible (not all of them can be uninstalled)
Search Windows Defender Firewall and go to Advanced settings
Click Windows Defender Firewall Properties
Change the firewall state to Off for the Domain, Private, and Public Profile then click Apply then Okay

The Windows 10 VM should be properly configured to be more vulnerable now. Now we have to make sure the virtual machine is on the same network as the host machine that will perform the scan.

Within the VM menu, click on Devices, Network, then Network Settings
Within the drop-down menu for Attached to, select the option Host-Only Adapter
Open Command Prompt as an administrator on your VM and type the command ipconfig (this will show you your VM's IPv4 address)
Now on your host computer, open Command Prompt and ping the VM's IPv4 address
If the ping is successful, you are good to go. If not, go back and see if you missed any changes.

Step 5: Install Nessus
Now we are going to download and install Nessus, a powerful vulnerability scanner.

Register for an activation code here
Once you're registered, click the blue button that says Download
Choose the version of Nessus you want to download based on the platform you are running on your PC, and click Download and confirm the license agreement
Locate the Nessus installation file you have just downloaded and open the executable
Go through the installation wizard process and confirm the installation
After the initial installation, a new page in your private browser will open on localhost or port 8834 where you will finish the installation process.
On that new page, click on the button Connect via SSL
If you get a warning about potential security risk, just select Advanced and then click Accept the Risk and Continue
You won't be changing any settings or register offline, So select Continue
From the deployment options, choose Register for Nessus Essentials
Skip the registration process, copy the activation code you got in your email, and past the activation code
Create your credentials for Nessus and finish the installation process

Step 6: Configure Nessus for scanning

Once Nessus is opened, go to the My Scans section and click Create a new scan
Here you will different scanning options to assess and improve security
- Basic Network Scan (understand overall security posture)
- Malware Scan (help identify malware)
- WannaCry Ransomware (find indicators of WannaCry)
- etc.
Choose Basic Network Scan 
We just need to fill in 2 fields here:
- the name of your scan (this can be whatever you want)
- the IP address or subnet range you want to target (aka the IPv4 address of your Windows VM in this case)
Click Save

Step 7: Nessus Initial Scan
Now we will run an initial scan of our Windows 10 VM using Nessus. 
Make sure your have the VM running within VirtualBox before you start your scan for it to work.

Within the My Scans section, click the Launch arrow for the scan you just created for the scan to start
Click on the name of your scan to see the scan in real-time 
- On the right hand side, you can see a visualizations of the vulnerabilities detected
To get more detail information, click on the blue bar under vulnerabilities

The vulnerabilities are grouped into different sections based on the technology being used and relevance.

Step 8: Nessus Credential Scan Setup
Now we are going to add a credential to our scan to get even more detailed information.
Go to my scans and click on your saved scan
In the top right corner, click on a button Configure
Click on the Credentials section
Because your VM is using Windows 10, choose Windows from the 2 categories
For Authentication method, select Password from the drop-down menu
Fill in the Username, Password, and Domain you used during your VM's creation process

However, if you try to run the scan, you will receive a notification that the account used doesn't have the necessary privileges. To fix that, do the following: 
Go back to the Windows VM and search for Services
Find the Remote Registry and double click on it
Change the startup type to Automatic
Then search and select User Account Control
Slide the bar to the bottom to Never Notify and click on OK (this will make is so user account control prompts don't interrupt your scan)
Search Registry Editor and open it as a administrator
Click to the following registry in this order: HKEY_LOCAL_MACHINE, SOFTWARE, Microsoft, Windows, CurrentVersion, Policies, System
Within the System folder, right click in the blank space on the right side of the screen and hover over New and select Default 32 bit value from the drop down menu 
Name the new registry value you just created: LocalAccountTokenFilterPolicy 
(make sure you spell it exactly as shown for everything to work!)
Double click on the DWord value you just created and named to edit its properties and change the Value data field from 0 to 1, then click Okay to save changes
Restart your VM

This process will allow Nessus to use credential scanning to perform a more comprehensive security scans of your system.
